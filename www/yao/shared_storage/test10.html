<body>
<script>
window.sharedStorage.worklet.addModule("test10.js");

function runURLSelectionOperation() {
  window.sharedStorage.runURLSelectionOperation("test-operation", ["https://www.google.com/", "https://cr.kungfoo.net/yao/shared_storage/supports_fenced_frame.php"], {data: {'name': 'experimentA'}}).then((opaque_url) => {
    console.log(opaque_url);
    document.getElementById("frame1").src = opaque_url;
  });
}

function runURLSelectionOperationFail() {
  window.sharedStorage.runURLSelectionOperation("test-operation-fail", ["https://www.google.com/", "https://cr.kungfoo.net/yao/shared_storage/supports_fenced_frame.php"], {data: {'name': 'experimentA'}}).then((opaque_url) => {
    console.log(opaque_url);
    document.getElementById("frame1").src = opaque_url;
  });
}
  
function runURLSelectionOperationFast() {
  window.sharedStorage.runURLSelectionOperation("test-operation-fast", ["https://www.google.com/", "https://cr.kungfoo.net/yao/shared_storage/supports_fenced_frame.php"], {data: {'name': 'experimentA'}}).then((opaque_url) => {
    console.log(opaque_url);
    document.getElementById("frame1").src = opaque_url;
  });
}

function runURLSelectionOperationFailFast() {
  window.sharedStorage.runURLSelectionOperation("test-operation-fail-fast", ["https://www.google.com/", "https://cr.kungfoo.net/yao/shared_storage/supports_fenced_frame.php"], {data: {'name': 'experimentA'}}).then((opaque_url) => {
    console.log(opaque_url);
    document.getElementById("frame1").src = opaque_url;
  });
}
  
function navigateToFail() {
  document.getElementById("frame1").src = "urn:uuid:12345678987654321";
}
 
</script>
<button onclick="runURLSelectionOperation()">runURLSelectionOperation (worklet success) and navigate fencedframe</button>
<br>
<button onclick="runURLSelectionOperationFail()">runURLSelectionOperation (worklet error) and navigate fencedframe</button>
<br>
<button onclick="runURLSelectionOperationFast()">runURLSelectionOperation (worklet success; finish quickly) and navigate fencedframe</button>
<br>
<button onclick="runURLSelectionOperationFailFast()">runURLSelectionOperation (worklet error; finish quickly) and navigate fencedframe</button>
<br>
<button onclick="navigateToFail()">navigate fencedframe to non-existent urn:uuid</button>
<br>  
<fencedframe id="frame1" mode="opaque-ads"></fencedframe>
<br>
</body>
